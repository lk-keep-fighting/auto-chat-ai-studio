# 视频处理自动化流程

## 概述
本流程基于浏览器自动化，通过 Google AI Studio 处理视频文件，提取数据并生成结构化的 Excel 文件。

## 项目路径配置
- **视频文件夹**: `assets/Process_Folder/videos/`
- **提示词文件**: `assets/Process_Folder/prompts.xlsx`
- **输出文件夹**: `assets/Process_Folder/[视频名称]/`
- **最终处理**: `assets/vidoes/clips.xlsx` 和 `assets/vidoes/process_video.py`

---

## 处理流程

### 步骤 1: 准备视频列表
1. 确认 `assets/Process_Folder/videos/VideoList.csv` 文件已存在
2. 文件包含：
   - 视频名称
   - 视频时长
3.等待用户确认已打开Google AI Studio对话页，且所有账号已登录

### 步骤 2: 准备提示词文件
1. 打开 `assets/Process_Folder/prompts.xlsx`
2. 从 `VideoList.csv` 中读取**第一个视频**的信息
3. 将视频名称和时长复制到 `prompts.xlsx` 对应字段：
   - 文件名称
   - 视频时长

### 步骤 3: 上传视频到 AI Studio
1. 打开浏览器访问: https://aistudio.google.com/
2. 复制 `prompts.xlsx` 中的**步骤1提示词**
3. 上传对应的视频文件
4. 等待视频上传完成
5. 点击 **Run** 按钮（Ctrl+Enter）

### 步骤 4: AI 对话处理
1. 逐一复制提示词（步骤2-25）到对话框
2. 与 AI 对话，让其输出所需资料
3. **异常处理**: 如果出现 `Content blocked` 提示
   - 在对话框输入: `继续`
   - 等待 AI 继续处理

### 步骤 5: 保存输出数据
1. 完成全部 25 个步骤后，重点关注：
   - **步骤23**: 保存输出的 4 个文件资料
   - **步骤25**: 提取输出数据
2. 将数据保存为 Excel 文件
3. 在 `assets/Process_Folder/` 下创建以**视频文件名**命名的文件夹
4. 将所有生成的文件保存到该文件夹中

### 步骤 6: 循环处理剩余视频
1. 返回**步骤2**
2. 从 `VideoList.csv` 读取**下一个视频**的名称和时长
3. 重复步骤2-5
4. 直到处理完 `VideoList.csv` 中的所有视频

### 步骤 7: 合并数据并最终处理
1. 将所有提取的 Excel 表合并为一个总表
2. 复制粘贴数据到 `assets/vidoes/clips.xlsx`
3. 执行 `assets/vidoes/process_video.py` 完成最终处理
4. **任务完成** ✓

---

## 自动化要点

### 浏览器操作
- 自动打开 Google AI Studio
- 自动上传视频文件
- 自动复制粘贴提示词
- 自动点击 Run 按钮
- 自动处理异常（Content blocked）
- 自动检测 "You've reached your rate limit" 错误
- 自动切换到下一个可用的 Google 账号
- 记录已切换的账号，避免重复切换

### 数据处理
- 自动读取 CSV 文件
- 自动填充 Excel 表格
- 自动保存输出文件
- 自动创建文件夹
- 自动合并多个 Excel 文件

### 循环控制
- 遍历 VideoList.csv 中的所有视频
- 每个视频执行完整的 25 步流程
- 自动进入下一个视频处理

---

## 注意事项
1. 确保 `VideoList.csv` 文件已准备好（包含视频名称和时长）
2. 视频上传需要等待完成后再执行后续操作
3. 遇到 `Content blocked` 时自动输入"继续"
4. 自动检测 "You've reached your rate limit" 错误
5. 自动切换到下一个可用的 Google 账号
6. 记录本次运行已切换的账号，避免重复切换
7. 每个视频的输出文件需保存到独立文件夹
8. 最终合并时注意数据格式一致性


