# 视频处理自动化项目

## 📖 项目概述

这是一个基于 Python + Playwright 的浏览器自动化工具，用于批量处理视频并通过 Google AI Studio 提取数据。

## 🎯 主要功能

- ✅ 自动读取视频列表并批量处理
- ✅ 自动上传视频到 Google AI Studio
- ✅ 自动执行 25 步 AI 对话流程
- ✅ 智能处理 "Content blocked" 等异常
- ✅ 自动保存特定步骤的输出数据
- ✅ 自动合并所有 Excel 文件
- ✅ 完整的日志和截图记录
- ✅ 支持错误重试和恢复

## 📁 项目结构

```
.
├── video_automation.py      # 主自动化脚本
├── config.py                # 配置文件
├── test_connection.py       # 测试脚本
├── requirements.txt         # Python 依赖
├── setup.sh                 # 安装脚本
├── run.sh                   # 启动脚本
├── README.md                # 项目说明
├── 使用指南.md              # 详细使用指南
├── 视频处理流程.md          # 流程文档
├── automation.log           # 运行日志（自动生成）
├── screenshots/             # 截图目录（自动生成）
└── assets/
    ├── Process_Folder/
    │   ├── prompts.xlsx     # 提示词文件
    │   ├── videos/
    │   │   ├── VideoList.csv
    │   │   └── *.mp4
    │   └── [视频名称]/      # 输出目录（自动生成）
    └── vidoes/
        ├── clips.xlsx       # 合并数据（自动生成）
        └── process_video.py
```

## 🚀 快速开始

### 1. 安装

```bash
./setup.sh
```

### 2. 运行

```bash
./run.sh
```

或

```bash
python video_automation.py
```

## 📚 文档

- **[README.md](README.md)** - 项目基本说明
- **[使用指南.md](使用指南.md)** - 详细使用教程
- **[视频处理流程.md](视频处理流程.md)** - 业务流程说明

## 🔧 核心技术

- **Python 3.x** - 主要编程语言
- **Playwright** - 浏览器自动化框架
- **Pandas** - 数据处理
- **OpenPyXL** - Excel 文件操作

## ⚙️ 配置说明

所有配置项都在 `config.py` 中，包括：

- 路径配置
- 浏览器配置
- 等待时间配置
- 页面选择器配置
- 日志配置
- 重试配置

详见 [使用指南.md](使用指南.md)

## 🎬 工作流程

```
1. 读取 VideoList.csv
   ↓
2. 更新 prompts.xlsx
   ↓
3. 打开 Google AI Studio
   ↓
4. 上传视频
   ↓
5. 执行 25 步对话
   ├─ 自动发送提示词
   ├─ 等待 AI 响应
   ├─ 处理异常
   └─ 保存输出
   ↓
6. 循环处理下一个视频
   ↓
7. 合并所有 Excel 文件
   ↓
8. 运行最终处理脚本
   ↓
9. 完成！
```

## 📊 输出说明

### 1. 步骤输出

每个视频会生成独立文件夹，包含：
- `step_23_output.xlsx` - 步骤 23 的输出
- `step_25_output.xlsx` - 步骤 25 的输出

### 2. 合并数据

所有视频处理完成后：
- `assets/vidoes/clips.xlsx` - 合并所有数据

### 3. 日志和截图

- `automation.log` - 详细运行日志
- `screenshots/` - 各步骤截图（可选）

## 🐛 调试

### 测试连接

```bash
python test_connection.py
```

### 查看日志

```bash
cat automation.log
# 或实时查看
tail -f automation.log
```

### 启用调试模式

编辑 `config.py`：

```python
DEBUG_MODE = True
LOG_LEVEL = "DEBUG"
SAVE_SCREENSHOTS = True
```

## ⚠️ 注意事项

1. **首次使用需要登录** - 手动登录 Google 账号
2. **网络稳定性** - 确保网络连接稳定
3. **视频大小** - 大视频需要更长上传时间
4. **API 限制** - 避免过于频繁的请求
5. **选择器更新** - 页面结构变化时需要更新选择器

## 🔄 更新日志

### v1.0.0 (2024-12-05)

- ✅ 初始版本发布
- ✅ 支持批量视频处理
- ✅ 自动化 25 步对话流程
- ✅ 异常处理和重试机制
- ✅ 完整的日志和截图功能

## 📝 待办事项

- [ ] 支持更多视频格式
- [ ] 添加进度条显示
- [ ] 支持断点续传
- [ ] 优化选择器自动检测
- [ ] 添加 GUI 界面

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License

---

**祝使用愉快！** 🎉
