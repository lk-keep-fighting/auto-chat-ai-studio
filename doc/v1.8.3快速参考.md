# v1.8.3 快速参考

## 问题
步骤23提取的内容无法识别为SRT格式，保存为文本文件

## 解决方案
✅ 新增HTML调试功能 + 智能SRT提取方法

## 新功能

### 1. HTML调试
自动保存步骤23的HTML和文本内容到 `debug/` 文件夹

### 2. 提取策略
- 策略1：从代码块提取（`<pre>`, `<code>`）
- 策略2：从下载按钮附近提取
- 策略3：从响应文本中搜索SRT格式

## 使用方法

### 自动处理
无需手动操作，代码会自动：
1. 保存HTML到 `debug/` 文件夹
2. 尝试多种策略提取SRT内容
3. 保存为 `.srt` 文件

### 调试分析
```bash
# 1. 查看保存的调试文件
ls -la assets/Process_Folder/*/debug/

# 2. 分析HTML结构
pip install beautifulsoup4  # 首次使用
python analyze_step23_html.py

# 3. 手动查看HTML
open assets/Process_Folder/Episode3/debug/step_23_response_*.html
```

## 验证方法
```bash
# 检查是否生成SRT文件
ls -la assets/Process_Folder/*/step_23_output_*.srt

# 查看文件内容
head -20 assets/Process_Folder/Episode3/step_23_output_1.srt
```

## 配置选项
```python
# config.py
SAVE_DEBUG_HTML = True  # 是否保存调试HTML
```

## 日志关键词
- 💾 "已保存HTML调试文件" - HTML已保存
- ✅ "通过下载按钮获取到 X 字符的SRT内容" - 成功
- ⚠️ "未找到SRT内容" - 失败，回退到文本提取

## 调试工具
- `analyze_step23_html.py` - 分析HTML结构，查找SRT内容

## 影响
- 新的步骤23处理：自动保存HTML + 智能提取
- 提高SRT提取成功率
- 便于调试和优化
