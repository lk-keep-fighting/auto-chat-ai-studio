# v1.7.4 æ›´æ–°è¯´æ˜

## æ–°å¢åŠŸèƒ½

### æ”¯æŒVideoList.csvæ–°æ ¼å¼ â­â­â­â­

**å˜æ›´è¯´æ˜**ï¼š
- VideoList.csv å¢åŠ äº† `line1` å’Œ `line2` ä¸¤åˆ—
- ç¨‹åºè‡ªåŠ¨è¯»å–å¹¶ä¼ é€’è¿™äº›å­—æ®µåˆ°æç¤ºè¯æ–‡ä»¶

**æ–°æ ¼å¼**ï¼š
```csv
Filename,line1,line2,Duration
Episode3.mp4,bat,223,01:59.4
Episode1.mp4,bat,223,03:32.5
Episode2.mp4,bat,223,02:14.9
```

**æ—§æ ¼å¼**ï¼ˆä»ç„¶å…¼å®¹ï¼‰ï¼š
```csv
Filename,Duration
video1.mp4,12:58
video2.mp4,10:30
```

## æ”¹è¿›å†…å®¹

### 1. å¢å¼º `load_video_list()` æ–¹æ³•

**ä¿®æ”¹å‰**ï¼š
```python
def load_video_list(self):
    df = pd.read_csv(self.video_list_file)
    videos = []
    for _, row in df.iterrows():
        videos.append({
            "filename": row["Filename"],
            "duration": row["Duration"]
        })
    return videos
```

**ä¿®æ”¹å**ï¼š
```python
def load_video_list(self):
    df = pd.read_csv(self.video_list_file)
    videos = []
    for _, row in df.iterrows():
        video_info = {
            "filename": row["Filename"],
            "duration": row["Duration"]
        }
        # å¦‚æœæœ‰line1å’Œline2åˆ—ï¼Œä¹ŸåŠ è½½è¿›æ¥
        if "line1" in row:
            video_info["line1"] = row["line1"]
        if "line2" in row:
            video_info["line2"] = row["line2"]
        videos.append(video_info)
    return videos
```

**æ”¹è¿›æ•ˆæœ**ï¼š
- âœ… è‡ªåŠ¨æ£€æµ‹å¹¶åŠ è½½ `line1` å’Œ `line2` å­—æ®µ
- âœ… å‘åå…¼å®¹æ—§æ ¼å¼ï¼ˆæ²¡æœ‰è¿™äº›å­—æ®µä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼‰
- âœ… çµæ´»æ”¯æŒæœªæ¥å¯èƒ½å¢åŠ çš„å…¶ä»–å­—æ®µ

### 2. å¢å¼º `update_prompts_file()` æ–¹æ³•

**ä¿®æ”¹å‰**ï¼š
```python
def update_prompts_file(self, video_name, duration):
    df = self.load_prompts()
    if "æ–‡ä»¶åç§°" in df.columns:
        df.loc[0, "æ–‡ä»¶åç§°"] = video_name
    if "è§†é¢‘æ—¶é•¿" in df.columns:
        df.loc[0, "è§†é¢‘æ—¶é•¿"] = duration
    df.to_excel(self.prompts_file, index=False)
    return True
```

**ä¿®æ”¹å**ï¼š
```python
def update_prompts_file(self, video_info):
    """æ›´æ–°æç¤ºè¯æ–‡ä»¶ä¸­çš„è§†é¢‘ä¿¡æ¯
    
    Args:
        video_info: å­—å…¸ï¼ŒåŒ…å« filename, duration, line1, line2 ç­‰å­—æ®µ
    """
    df = self.load_prompts()
    
    # æ›´æ–°è§†é¢‘åç§°
    if "è§†é¢‘åç§°" in df.columns:
        df.loc[0, "è§†é¢‘åç§°"] = video_info.get("filename", "")
    
    # æ›´æ–°è§†é¢‘æ—¶é•¿
    if "è§†é¢‘æ—¶é•¿" in df.columns:
        df.loc[0, "è§†é¢‘æ—¶é•¿"] = video_info.get("duration", "")
    
    # æ›´æ–°line1
    if "line1" in df.columns and "line1" in video_info:
        df.loc[0, "line1"] = video_info.get("line1", "")
    
    # æ›´æ–°line2ï¼ˆæ³¨æ„Excelä¸­å¯èƒ½æ˜¯lin2çš„æ‹¼å†™é”™è¯¯ï¼‰
    if "line2" in df.columns and "line2" in video_info:
        df.loc[0, "line2"] = video_info.get("line2", "")
    elif "lin2" in df.columns and "line2" in video_info:
        df.loc[0, "lin2"] = video_info.get("line2", "")
    
    df.to_excel(self.prompts_file, index=False)
    logger.info(f"âœ… æ›´æ–°æç¤ºè¯æ–‡ä»¶: {video_info.get('filename')} - {video_info.get('duration')}")
    if "line1" in video_info:
        logger.info(f"   line1: {video_info.get('line1')}")
    if "line2" in video_info:
        logger.info(f"   line2: {video_info.get('line2')}")
    return True
```

**æ”¹è¿›æ•ˆæœ**ï¼š
- âœ… æ¥å—å®Œæ•´çš„ `video_info` å­—å…¸
- âœ… è‡ªåŠ¨æ›´æ–° `line1` å’Œ `line2` å­—æ®µ
- âœ… å…¼å®¹ Excel ä¸­çš„æ‹¼å†™é”™è¯¯ï¼ˆ`lin2`ï¼‰
- âœ… è¯¦ç»†çš„æ—¥å¿—è¾“å‡º
- âœ… å‘åå…¼å®¹ï¼ˆæ²¡æœ‰è¿™äº›å­—æ®µä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼‰

### 3. æ›´æ–°è°ƒç”¨æ–¹å¼

**ä¿®æ”¹å‰**ï¼š
```python
self.update_prompts_file(video_name, duration)
```

**ä¿®æ”¹å**ï¼š
```python
self.update_prompts_file(video_info)
```

**æ”¹è¿›æ•ˆæœ**ï¼š
- âœ… ä¼ é€’å®Œæ•´çš„è§†é¢‘ä¿¡æ¯
- âœ… æ”¯æŒæ‰€æœ‰å­—æ®µçš„æ›´æ–°
- âœ… æ›´çµæ´»çš„æ‰©å±•æ€§

## ä½¿ç”¨ç¤ºä¾‹

### VideoList.csv

```csv
Filename,line1,line2,Duration
Episode3.mp4,bat,223,01:59.4
Episode1.mp4,bat,223,03:32.5
Episode2.mp4,bat,223,02:14.9
```

### æ—¥å¿—è¾“å‡º

```
âœ… åŠ è½½äº† 3 ä¸ªè§†é¢‘
ğŸ¬ å¼€å§‹å¤„ç†è§†é¢‘: Episode3.mp4
âœ… æ›´æ–°æç¤ºè¯æ–‡ä»¶: Episode3.mp4 - 01:59.4
   line1: bat
   line2: 223
```

### prompts.xlsx

ç¨‹åºä¼šè‡ªåŠ¨æ›´æ–° prompts.xlsx ä¸­çš„ä»¥ä¸‹åˆ—ï¼š
- `è§†é¢‘åç§°`: Episode3.mp4
- `è§†é¢‘æ—¶é•¿`: 01:59.4
- `line1`: bat
- `line2` (æˆ– `lin2`): 223

## å…¼å®¹æ€§

### å‘åå…¼å®¹

å¦‚æœ VideoList.csv ä½¿ç”¨æ—§æ ¼å¼ï¼ˆæ²¡æœ‰ line1 å’Œ line2ï¼‰ï¼š

```csv
Filename,Duration
video1.mp4,12:58
video2.mp4,10:30
```

ç¨‹åºä»ç„¶èƒ½æ­£å¸¸å·¥ä½œï¼Œåªæ˜¯ä¸ä¼šæ›´æ–° line1 å’Œ line2 å­—æ®µã€‚

### å­—æ®µæ£€æµ‹

ç¨‹åºä¼šè‡ªåŠ¨æ£€æµ‹ï¼š
- VideoList.csv ä¸­æ˜¯å¦æœ‰ `line1` å’Œ `line2` åˆ—
- prompts.xlsx ä¸­æ˜¯å¦æœ‰ `line1` å’Œ `line2`ï¼ˆæˆ– `lin2`ï¼‰åˆ—
- åªæœ‰å½“ä¸¤è¾¹éƒ½æœ‰å¯¹åº”å­—æ®µæ—¶æ‰ä¼šæ›´æ–°

## ç‰ˆæœ¬ä¿¡æ¯

- **ç‰ˆæœ¬å·**: v1.7.4
- **å‘å¸ƒæ—¥æœŸ**: 2024-12-06
- **æ›´æ–°ç±»å‹**: åŠŸèƒ½å¢å¼º + å‘åå…¼å®¹

## æ–‡ä»¶å˜æ›´

### ä¿®æ”¹çš„æ–‡ä»¶

1. **video_automation.py**
   - å¢å¼º `load_video_list()` æ–¹æ³•
   - å¢å¼º `update_prompts_file()` æ–¹æ³•
   - æ›´æ–°è°ƒç”¨æ–¹å¼

2. **VERSION**
   - æ›´æ–°åˆ° 1.7.4

## æµ‹è¯•éªŒè¯

### æµ‹è¯•æ–°æ ¼å¼

1. å‡†å¤‡ VideoList.csvï¼š
```csv
Filename,line1,line2,Duration
test.mp4,bat,223,01:00
```

2. è¿è¡Œç¨‹åºï¼š
```bash
python video_automation.py
```

3. æ£€æŸ¥æ—¥å¿—ï¼š
```
âœ… æ›´æ–°æç¤ºè¯æ–‡ä»¶: test.mp4 - 01:00
   line1: bat
   line2: 223
```

4. æ£€æŸ¥ prompts.xlsxï¼š
- è§†é¢‘åç§°åˆ—åº”è¯¥æ˜¯ `test.mp4`
- è§†é¢‘æ—¶é•¿åˆ—åº”è¯¥æ˜¯ `01:00`
- line1 åˆ—åº”è¯¥æ˜¯ `bat`
- line2 åˆ—åº”è¯¥æ˜¯ `223`

### æµ‹è¯•æ—§æ ¼å¼

1. å‡†å¤‡ VideoList.csvï¼š
```csv
Filename,Duration
test.mp4,01:00
```

2. è¿è¡Œç¨‹åºï¼š
```bash
python video_automation.py
```

3. æ£€æŸ¥æ—¥å¿—ï¼š
```
âœ… æ›´æ–°æç¤ºè¯æ–‡ä»¶: test.mp4 - 01:00
```

4. ç¨‹åºæ­£å¸¸å·¥ä½œï¼Œä¸ä¼šæŠ¥é”™

## æ³¨æ„äº‹é¡¹

### Excel æ‹¼å†™é”™è¯¯

å¦‚æœ prompts.xlsx ä¸­çš„åˆ—åæ˜¯ `lin2`ï¼ˆæ‹¼å†™é”™è¯¯ï¼‰ï¼Œç¨‹åºä¼šè‡ªåŠ¨è¯†åˆ«å¹¶æ›´æ–°è¯¥åˆ—ã€‚

### å­—æ®µç±»å‹

- `line1` å’Œ `line2` å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ç­‰ï¼‰
- ç¨‹åºä¼šè‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²å­˜å‚¨

### ç©ºå€¼å¤„ç†

å¦‚æœ VideoList.csv ä¸­æŸè¡Œçš„ line1 æˆ– line2 ä¸ºç©ºï¼š
- ç¨‹åºä¼šä½¿ç”¨ç©ºå­—ç¬¦ä¸² `""`
- ä¸ä¼šæŠ¥é”™

## ç›¸å…³æ–‡æ¡£

- **[v1.7.3æ›´æ–°è¯´æ˜.md](v1.7.3æ›´æ–°è¯´æ˜.md)** - ä¿®å¤å“åº”é€‰æ‹©å™¨
- **[v1.7.2æ›´æ–°è¯´æ˜.md](v1.7.2æ›´æ–°è¯´æ˜.md)** - å¢å¼ºæ—¥å¿—
- **[ä½¿ç”¨æŒ‡å—.md](ä½¿ç”¨æŒ‡å—.md)** - å®Œæ•´ä½¿ç”¨æ•™ç¨‹

## ä¸‹ä¸€æ­¥

1. æµ‹è¯•æ–°æ ¼å¼çš„ VideoList.csv
2. éªŒè¯ prompts.xlsx æ˜¯å¦æ­£ç¡®æ›´æ–°
3. æ›´æ–° CHANGELOG å’Œ README

## æ€»ç»“

v1.7.4 å¢å¼ºäº†å¯¹ VideoList.csv æ–°æ ¼å¼çš„æ”¯æŒï¼Œè‡ªåŠ¨è¯»å–å’Œä¼ é€’ `line1` å’Œ `line2` å­—æ®µåˆ°æç¤ºè¯æ–‡ä»¶ã€‚åŒæ—¶ä¿æŒå‘åå…¼å®¹ï¼Œæ—§æ ¼å¼çš„ CSV æ–‡ä»¶ä»ç„¶èƒ½æ­£å¸¸å·¥ä½œã€‚
